@page "/"

@rendermode InteractiveServer

<ul>
    <li>Query Token : @Token</li>
    <li>Bearer Token : @_bearerToken</li>
    <li>
        Current Time : @_time
        <input type="button" value="Update" @onclick="@UpdateTimeClicked" />
    </li>
</ul>

@code
{
    [SupplyParameterFromQuery] private string? Token { get; set; }
    [Inject] private IHttpContextAccessor HttpContextAccessor { get; set; } = null!;

    DateTime _time = DateTime.Now;
    private static string _bearerToken = "Not Provided";

    protected override Task OnInitializedAsync()
    {
        var bearerHeader = HttpContextAccessor.HttpContext.Request.Headers["Authorization"];
        if (bearerHeader.Count > 0)
        {
            _bearerToken = bearerHeader[0].Substring("Bearer ".Length);
        }

        return base.OnInitializedAsync();
    }

    private Task UpdateTimeClicked()
    {
        _time = DateTime.Now;

        return Task.CompletedTask;
    }
}